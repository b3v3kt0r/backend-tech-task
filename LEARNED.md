# LEARNED — DuckDB

## Засвоєно в процесі виконання
- DuckDB — вбудована стовпчикова база даних, що добре підходить для аналітики над великими масивами даних.
- Підтримує SQL-запити, JSON-колонки, агрегатні функції і швидкі читання/записи у файл.
- Можна легко інтегрувати з Python і Celery для періодичного синхронного перенесення даних з PostgreSQL.

## Як інтегрував(ла) у рішення
- Модуль app.db.duck для підключення (get_duck_conn) і вставки/читання даних (write_analytics, query_analytics).
- Celery таска sync_events_to_duck для синхронізації нових подій з PostgreSQL у DuckDB (холодний шар).
- Використовується у статистичних ендпоінтах /stats/dau, /stats/top-events, /stats/retention для швидкої аналітики без навантаження на основну БД.

## Плюси / Мінуси / Трейд-офи

**Плюси**
- Легко інтегрується в Python-проєкти, не потребує окремого сервера.
- Стовпчикова організація таблиць → швидкі аналітичні запити (DAU, retention, top-events).

**Мінуси**
- Не підходить для високочастотних одночасних записів (конкуренція може викликати блокування).
- Для паралельних Celery воркерів потрібне налаштування PRAGMA threads=1 і/або --concurrency=1.

**Коли використовувати / коли уникати**
- Використовувати, якщо потрібен швидкий аналітичний доступ до історичних подій без навантаження на основну БД. 
- Уникати, якщо потрібні високочастотні одночасні записи з кількох воркерів.
